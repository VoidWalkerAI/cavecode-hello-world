<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>CaveCode â€” Hello World Live</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      background: #05060a;
      color: #f3f4f6;
    }
    header {
      padding: 1rem 1.5rem;
      border-bottom: 1px solid #1f2933;
      background: radial-gradient(circle at top left, #1f2937, #05060a 55%);
    }
    header h1 {
      margin: 0;
      font-size: 1.3rem;
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }
    header p {
      margin: 0.25rem 0 0;
      font-size: 0.8rem;
      color: #9ca3af;
    }
    main {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      padding: 1rem;
    }
    @media (min-width: 900px) {
      main {
        flex-direction: row;
        height: calc(100vh - 70px);
      }
    }
    .panel {
      background: #0b0c10;
      border-radius: 0.75rem;
      border: 1px solid #1f2933;
      padding: 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.45);
    }
    .panel h2 {
      margin: 0;
      font-size: 1rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: #d1d5db;
    }
    .panel small {
      color: #6b7280;
      font-size: 0.75rem;
    }
    #cavecode-input {
      width: 100%;
      height: 100%;
      min-height: 260px;
      resize: vertical;
      background: #020617;
      color: #e5e7eb;
      border-radius: 0.5rem;
      border: 1px solid #1f2933;
      padding: 0.75rem;
      font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo,
        Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 0.8rem;
      line-height: 1.35;
      white-space: pre;
    }
    @media (min-width: 900px) {
      #cavecode-input {
        flex: 1;
        height: 100%;
      }
      .panel.cavecode {
        flex: 1;
      }
      .panel.app {
        flex: 1;
      }
    }
    .button-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }
    button {
      border-radius: 999px;
      border: none;
      padding: 0.5rem 0.9rem;
      font-size: 0.8rem;
      font-weight: 600;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      cursor: pointer;
      background: linear-gradient(135deg, #f97316, #ea580c);
      color: #111827;
      box-shadow: 0 4px 14px rgba(234, 88, 12, 0.6);
      transition: transform 0.07s ease, box-shadow 0.07s ease,
        filter 0.07s ease;
    }
    button.secondary {
      background: #111827;
      color: #e5e7eb;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.5);
    }
    button:hover {
      transform: translateY(-1px);
      filter: brightness(1.05);
      box-shadow: 0 6px 20px rgba(234, 88, 12, 0.75);
    }
    button.secondary:hover {
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.7);
    }
    button:active {
      transform: translateY(0);
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.7);
    }
    .app-shell {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      background: radial-gradient(circle at top, #111827 0, #020617 55%);
      border-radius: 0.75rem;
      border: 1px solid #1f2933;
      padding: 1rem;
    }
    .app-title {
      font-size: 1rem;
      font-weight: 600;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      color: #fbbf24;
    }
    .app-display {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 1rem;
      border-radius: 0.75rem;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid #1f2937;
      font-size: 1rem;
    }
    .app-footer {
      font-size: 0.75rem;
      color: #9ca3af;
      display: flex;
      justify-content: space-between;
      gap: 0.5rem;
      align-items: center;
      flex-wrap: wrap;
    }
    .app-status {
      font-size: 0.7rem;
      color: #6ee7b7;
    }
    code.inline {
      font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo,
        Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 0.75rem;
      background: #020617;
      padding: 0.05rem 0.25rem;
      border-radius: 0.25rem;
      border: 1px solid #1f2933;
    }
  </style>
</head>
<body>
  <header>
    <h1>CaveCode â€” Hello World Artifact</h1>
    <p>
      Left: raw CaveCode file. Right: live app rendered from that file.
      Change the knobs and hit <span class="inline-code">Apply CaveCode</span>.
    </p>
  </header>

  <main>
    <!-- Left: CaveCode artifact -->
    <section class="panel cavecode">
      <h2>ðŸª¨ CaveCode Artifact</h2>
      <small>Edit the safe knobs (HELLO_TEXT, INTERACTION_TEXT, TITLE_TEXT, FOOTER_CREDITS).</small>
      <textarea id="cavecode-input"></textarea>
      <div class="button-row">
        <button id="apply-btn">Apply CaveCode</button>
        <button id="reset-btn" class="secondary">Reset to Default</button>
      </div>
    </section>

    <!-- Right: Rendered app -->
    <section class="panel app">
      <h2>ðŸŽ® Rendered App</h2>
      <div class="app-shell">
        <div id="app-title" class="app-title"></div>
        <div id="app-message" class="app-display"></div>
        <div class="button-row">
          <button id="interact-btn">Interact with Artifact</button>
        </div>
        <div class="app-footer">
          <span id="app-footer"></span>
          <span id="app-status" class="app-status"></span>
        </div>
      </div>
    </section>
  </main>

  <script>
    // Default CaveCode Hello World artifact
    const defaultCaveCode = `â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
â–ˆ CAVECODE EXAMPLE â€” HELLO WORLD (v1.0)
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ

================================================
ðŸª¨ BLOCK 1 â€” SHELL
================================================
Title: Hello World (CaveCode)
Short Description:
  A minimal example showing how to structure a CaveCode file.

Goal:
  ðŸŒ Show the basic use of glyphs and blocks.

(LOCKED SHELL â€” change content freely, keep structure.)

================================================
ðŸŽ® BLOCK 2 â€” BEHAVIOR SUMMARY
================================================
On Start:
  - Display HELLO_TEXT.

On Input:
  - If user presses any key or taps:
      - Display INTERACTION_TEXT.

(This block describes behavior in human language, not code.)

================================================
ðŸ–ï¸ BLOCK 3 â€” TUNING KNOBS
================================================
HELLO_TEXT:          "Hello, CaveCode."
INTERACTION_TEXT:    "You just interacted with a CaveCode artifact."

# A simple renderer could map these into a UI or console output.

================================================
ðŸŒ BLOCK 4 â€” PUBLIC TEXT
================================================
TITLE_TEXT:          "CaveCode â€” Hello World"
FOOTER_CREDITS:      "Forged with the CaveCode Protocol."

================================================
ðŸ–ï¸ BLOCK 5 â€” HUMAN NOTES
================================================
# Try changing HELLO_TEXT above and see how your app reacts.
# This is the heart of CaveCode: easy tweaks, safe zones.`;

    function extractValue(line) {
      const idx = line.indexOf(":");
      if (idx === -1) return null;
      let value = line.slice(idx + 1).trim();
      if (
        (value.startsWith('"') && value.endsWith('"')) ||
        (value.startsWith("'") && value.endsWith("'"))
      ) {
        value = value.slice(1, -1);
      }
      return value;
    }

    function parseCaveCode(text) {
      const cfg = {
        helloText: "Hello, CaveCode.",
        interactionText: "You just interacted with a CaveCode artifact.",
        titleText: "CaveCode â€” Hello World",
        footerCredits: "Forged with the CaveCode Protocol."
      };

      const lines = text.split("\n");
      for (let raw of lines) {
        const line = raw.trim();
        if (line.startsWith("HELLO_TEXT")) {
          const v = extractValue(line);
          if (v) cfg.helloText = v;
        } else if (line.startsWith("INTERACTION_TEXT")) {
          const v = extractValue(line);
          if (v) cfg.interactionText = v;
        } else if (line.startsWith("TITLE_TEXT")) {
          const v = extractValue(line);
          if (v) cfg.titleText = v;
        } else if (line.startsWith("FOOTER_CREDITS")) {
          const v = extractValue(line);
          if (v) cfg.footerCredits = v;
        }
      }
      return cfg;
    }

    function applyCaveCode() {
      const text = document.getElementById("cavecode-input").value;
      const cfg = parseCaveCode(text);
      window.currentCaveConfig = cfg;

      document.getElementById("app-title").textContent = cfg.titleText;
      document.getElementById("app-message").textContent = cfg.helloText;
      document.getElementById("app-footer").textContent = cfg.footerCredits;
      document.getElementById("app-status").textContent =
        "Loaded from CaveCode artifact.";
    }

    function handleInteraction() {
      const cfg =
        window.currentCaveConfig ||
        parseCaveCode(document.getElementById("cavecode-input").value);
      document.getElementById("app-message").textContent =
        cfg.interactionText;
      document.getElementById("app-status").textContent =
        "Interaction event fired from CaveCode behavior.";
    }

    function resetToDefault() {
      document.getElementById("cavecode-input").value = defaultCaveCode;
      applyCaveCode();
      document.getElementById("app-status").textContent =
        "Reset to canonical Hello World artifact.";
    }

    window.addEventListener("DOMContentLoaded", () => {
      const input = document.getElementById("cavecode-input");
      input.value = defaultCaveCode;

      document
        .getElementById("apply-btn")
        .addEventListener("click", applyCaveCode);
      document
        .getElementById("interact-btn")
        .addEventListener("click", handleInteraction);
      document
        .getElementById("reset-btn")
        .addEventListener("click", resetToDefault);

      applyCaveCode(); // initial render
    });
  </script>
</body>
</html>
